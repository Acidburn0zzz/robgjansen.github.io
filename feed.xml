<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.2.1">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2016-10-21T20:06:15-04:00</updated><id>/</id><title>robgjansen.com</title><subtitle>Rob's personal website.</subtitle><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><entry><title>Paper describing Bitcoin Simulation will appear at CSET 2015</title><link href="/blog/2015/06/23/paper-describing-bitcoin-simulation-will-appear-at-cset-2015/" rel="alternate" type="text/html" title="Paper describing Bitcoin Simulation will appear at CSET 2015" /><published>2015-06-23T20:53:43-04:00</published><updated>2015-06-23T20:53:43-04:00</updated><id>/blog/2015/06/23/paper-describing-bitcoin-simulation-will-appear-at-cset-2015</id><content type="html" xml:base="/blog/2015/06/23/paper-describing-bitcoin-simulation-will-appear-at-cset-2015/">&lt;p&gt;Our paper entitled “&lt;a href=&quot;/publications/shadowbitcoin-cset2015.pdf&quot;&gt;Shadow-Bitcoin: Scalable Simulation via Direct Execution of Multi-threaded Applications&lt;/a&gt;” has been accepted to the 8th Workshop on Cybersecurity Experimenation and Test (CSET) 2015! It describes how we were able to run our own private Bitcoin network for experimental purposes using the &lt;a href=&quot;https://github.com/shadow/shadow&quot;&gt;Shadow simulator&lt;/a&gt;. The private Bitcoin network made it easy to debug our Bitcoin code modifications and test the attacks that are also presented in the paper, and we think it will be a useful starting point for future Bitcoin research and development.&lt;/p&gt;

&lt;p&gt;CSET is co-located with USENIX Security and will be held in DC on 2015/08/10. Check out the &lt;a href=&quot;https://www.usenix.org/conference/cset15/workshop-program&quot;&gt;full CSET 2015 program&lt;/a&gt;.&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="publication" /><summary>Our paper entitled “Shadow-Bitcoin: Scalable Simulation via Direct Execution of Multi-threaded Applications” has been accepted to the 8th Workshop on Cybersecurity Experimenation and Test (CSET) 2015! It describes how we were able to run our own private Bitcoin network for experimental purposes using the Shadow simulator. The private Bitcoin network made it easy to debug our Bitcoin code modifications and test the attacks that are also presented in the paper, and we think it will be a useful starting point for future Bitcoin research and development.</summary></entry><entry><title>I am co-chairing WPES 2015</title><link href="/blog/2015/05/17/i-am-co-chairing-wpes-2015/" rel="alternate" type="text/html" title="I am co-chairing WPES 2015" /><published>2015-05-17T14:15:51-04:00</published><updated>2015-05-17T14:15:51-04:00</updated><id>/blog/2015/05/17/i-am-co-chairing-wpes-2015</id><content type="html" xml:base="/blog/2015/05/17/i-am-co-chairing-wpes-2015/">&lt;p&gt;I am co-chairing the 2015 Workshop on Privacy in the Electronic Society. The call for papers is currently available on &lt;a href=&quot;https://wpes15.cs.umn.edu/&quot;&gt;the workshop website&lt;/a&gt;, and papers can be submitted through &lt;a href=&quot;https://wpes15-submit.cs.umn.edu/&quot;&gt;the submission site&lt;/a&gt;. Please consider submitting and join a discussion with the top minds in digital privacy.&lt;/p&gt;

&lt;p&gt;WPES is co-located with the &lt;a href=&quot;http://www.sigsac.org/ccs/CCS2015/&quot;&gt;22nd ACM Conference on Computer and Communications Security&lt;/a&gt; (CCS), which will take place in Denver, Colorado on October 12-16, 2015.&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="service" /><summary>I am co-chairing the 2015 Workshop on Privacy in the Electronic Society. The call for papers is currently available on the workshop website, and papers can be submitted through the submission site. Please consider submitting and join a discussion with the top minds in digital privacy.</summary></entry><entry><title>The Sniper Attack Won the NRL Berman Award</title><link href="/blog/2015/05/17/sniper-attack-won-berman-award/" rel="alternate" type="text/html" title="The Sniper Attack Won the NRL Berman Award" /><published>2015-05-17T14:10:04-04:00</published><updated>2015-05-17T14:10:04-04:00</updated><id>/blog/2015/05/17/sniper-attack-won-berman-award</id><content type="html" xml:base="/blog/2015/05/17/sniper-attack-won-berman-award/">&lt;p&gt;Our paper entitled “&lt;a href=&quot;publications/sniper-ndss2014.pdf&quot;&gt;The Sniper Attack: Anonymously Deanonymizing and Disabling the Tor Network&lt;/a&gt;” won the
47th Annual Alan Berman Research Publication Award! This award was given by the U.S. Naval Research Laboratory on 2015-04-17 for best paper in the Information Technology Division.&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="award" /><summary>Our paper entitled “The Sniper Attack: Anonymously Deanonymizing and Disabling the Tor Network” won the
47th Annual Alan Berman Research Publication Award! This award was given by the U.S. Naval Research Laboratory on 2015-04-17 for best paper in the Information Technology Division.</summary></entry><entry><title>Paper Accepted to WPES 2014</title><link href="/blog/2014/09/14/paper-accepted-to-wpes-2014/" rel="alternate" type="text/html" title="Paper Accepted to WPES 2014" /><published>2014-09-14T22:25:45-04:00</published><updated>2014-09-14T22:25:45-04:00</updated><id>/blog/2014/09/14/paper-accepted-to-wpes-2014</id><content type="html" xml:base="/blog/2014/09/14/paper-accepted-to-wpes-2014/">&lt;p&gt;Our paper entitled “&lt;a href=&quot;/publications/imux-wpes2014.pdf&quot;&gt;IMUX: Managing Tor Connections from Two to Infinity, and Beyond&lt;/a&gt;” has been accepted to WPES 2014!&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="publication" /><summary>Our paper entitled “IMUX: Managing Tor Connections from Two to Infinity, and Beyond” has been accepted to WPES 2014!</summary></entry><entry><title>Tor incentives research roundup: GoldStar, PAR, BRAIDS, LIRA, TEARS, and TorCoin</title><link href="/blog/2014/07/14/tor-incentives-research-roundup/" rel="alternate" type="text/html" title="Tor incentives research roundup: GoldStar, PAR, BRAIDS, LIRA, TEARS, and TorCoin" /><published>2014-07-14T16:42:00-04:00</published><updated>2014-07-14T16:42:00-04:00</updated><id>/blog/2014/07/14/tor-incentives-research-roundup</id><content type="html" xml:base="/blog/2014/07/14/tor-incentives-research-roundup/">&lt;blockquote&gt;
  &lt;p&gt;This post originally appeared &lt;a href=&quot;https://blog.torproject.org/blog/tor-incentives-research-roundup-goldstar-par-braids-lira-tears-and-torcoin&quot;&gt;on the TorProject blog&lt;/a&gt; summarizing the then-current state of research on Tor incentive schemes and related challenges. The post includes information about the new TorCoin and TEARS research papers that appeared at HotPETs later that week.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There has been a considerable amount of work in the area of Tor incentives since &lt;a href=&quot;https://blog.torproject.org/blog/two-incentive-designs-tor&quot;&gt;the last post on the topic in 2009&lt;/a&gt; (over 5 years ago!). This post will give an overview of some of the major new approaches, including two new designs that I co-authored that will appear at &lt;a href=&quot;https://www.petsymposium.org/2014/hotpets.php&quot;&gt;the Workshop on Hot Topics in Privacy Enhancing Technologies&lt;/a&gt; later this week. Before getting to those, I'll give background on Tor and discuss some of the social issues to help form a foundation of understanding.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;volunteer_resources&quot; href=&quot;#volunteer_resources&quot;&gt;Tor’s volunteer resource model&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The Tor network consists of a &lt;a href=&quot;http://torstatus.blutmagie.de/&quot;&gt;set of relays&lt;/a&gt; that provide bandwidth and other resources to forward traffic for Tor users. Anyone in any part of the world can contribute to Tor by downloading &lt;a href=&quot;https://www.torproject.org/download/download-easy.html.en&quot;&gt;the Tor software&lt;/a&gt; and &lt;a href=&quot;https://www.torproject.org/docs/tor-doc-relay.html.en&quot;&gt;configuring it to operate in relay mode&lt;/a&gt;. In fact, the Tor network is currently composed exclusively of such voluntarily-operated relays.&lt;/p&gt;
&lt;p&gt;There are many reasons existing relay operators might contribute to Tor. They may contribute because they really want a privacy-enhancing communication tool like Tor to exist, they believe in Tor’s philosophy of open source software and operational transparency, and they want Tor to succeed at its goals. They may wish to be part of the Tor community and the social movement to provide privacy-enhanced communication that connects people in all parts of the world. Tor may be practically useful to them for communication with others or to retrieve content that may otherwise be unavailable to them due to censorship or other network interference. Or they may be technically interested in the Tor software or network and the associated research problems raised by large, distributed systems. Finally, some may be interested for adversarial reasons, e.g., collecting information on the uses of the network or the content being transferred. All of these reasons provide intrinsic motivation for operators to contribute - they don’t expect any direct compensation for their contributions.&lt;/p&gt;
&lt;p&gt;The volunteer approach has succeeded so far: Tor now consists of &lt;a href=&quot;https://metrics.torproject.org/network.html#networksize&quot;&gt;over 5000 relays&lt;/a&gt; transferring &lt;a href=&quot;https://metrics.torproject.org/network.html#bandwidth&quot;&gt;between 4 and 5 GiB/s in aggregate&lt;/a&gt;. For the most part, this is &quot;organic&quot; growth obtained through community outreach, where volunteers first have personal contact with existing community members and become inspired to help.&lt;/p&gt;
&lt;p&gt;Whatever their reason for volunteering, relay operators not only contribute resources from the physical machines upon which their relays are executed, but also contribute the time involved with configuring, updating, and adjusting their relays as both the software and network mature. In many cases, operators also contribute monetarily through the direct purchase of dedicated machines or special fast connections to Internet Service Providers (ISPs), and exit relay operators spend social energy on maintaining relationships with their ISP (to make sure the ISP understands that requests coming from their machines are from Tor).&lt;/p&gt;
&lt;p&gt;However, because many people that are otherwise excited about or interested in Tor are incapable or unwilling to incur these expenses, there are far fewer Tor relays than Tor clients (users that use Tor to access content, e.g. via the Tor Browser Bundle, without directly contributing resources to the network). Expanding the set of relays could have many benefits: Tor could become faster, more reliable, and more secure while at the same time distributing trust among a larger and more diverse set of distributed peers. A larger network that is transferring a larger quantity and more diverse types of data will, in general, make it more difficult for an adversary to determine who is talking to whom. This means a safer Tor for everyone.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;incentives_motivation&quot; href=&quot;#incentives_motivation&quot;&gt;Incentives and motivation... say whuuuht?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There are many social and technical challenges involved with expanding the set of Tor relays. We focus here on the social issues surrounding how to encourage more people to run a relay in the first place by providing incentives (i.e., rewards) for relay operators, and later focus on how to do this without leaking information or otherwise hurting Tor’s anonymity.&lt;/p&gt;
&lt;p&gt;An important social issue to consider is that of maintaining the existing community of operators and how rewards could harm it. The presumption here is that existing relay operators are motivated to run relays for their own reasons - the act of contributing to Tor itself has intrinsic value to them. Then the question is: what would happen if we start rewarding operators through the use of an incentive system?&lt;/p&gt;
&lt;p&gt;The answer isn’t clear, and there are at least a couple of forks in the cognitive road with many more questions along the way. First, what would happen to the existing operators who used to feel good about volunteering but are now compensated with a reward that may have extrinsic value? Although the new reward may provide some extrinsic value, will it lower their original intrinsic value enough to cause them to &lt;a href=&quot;http://www.ted.com/talks/dan_pink_on_motivation&quot;&gt;lose their motivation&lt;/a&gt; to contribute? Will they continue their contributions but begin to expect the reward, such that &lt;a href=&quot;http://p2pfoundation.net/Intrinsic_vs._Extrinsic_Motivation#Why_Extrinsic_Motivation_Doesn.27t_Work&quot;&gt;if the reward is removed later they would no longer be motivated&lt;/a&gt; even though originally (before the reward) they were happy to contribute? Second, is the new group of operators attracted to Tor by the reward somehow less desirable than the existing group, because they don’t care as much about Tor or are more likely to stop contributions and leave the system more quickly than the existing volunteers? Is the fact that they have higher extrinsic motivation than intrinsic make them better or worse operators? Will they be less likely to incur the costs of saying &quot;no&quot; when people ask them to log or turn over traffic? Will they in fact be willing to sell logs if it increases their rewards? Third, how will the new group of operators affect the existing group? If their intrinsic motivation was low enough before the reward that they didn’t contribute, but high enough with the reward that they do contribute, are these new contributors going to somehow shift the &quot;community spirit&quot; into something that no longer has the value that it once had? Will this &lt;a href=&quot;http://p2pfoundation.net/Crowding_Out&quot;&gt;&quot;crowd out&quot; the intrinsically motivated individuals&lt;/a&gt; and cause existing operators to leave (a &lt;a href=&quot;http://p2pfoundation.net/Crowding_Out#Empirical_evidence_of_the_crowding_effect&quot;&gt;widely&lt;/a&gt; &lt;a href=&quot;http://www.roughtype.com/?p=479&quot;&gt;acknowledged&lt;/a&gt; &lt;a href=&quot;http://en.wikipedia.org/wiki/Motivation_crowding_theory&quot;&gt;theory&lt;/a&gt;)?&lt;/p&gt;
&lt;p&gt;The answers to these questions are not clear, though speculations abound. One response is that we will never know what will happen until we try it, but if we try it we may not like the result. Another is that if we try it and it succeeds, great; if it starts going badly, we can adapt and adjust.&lt;/p&gt;
&lt;p&gt;Researchers and other Tor community members have been interested in the Tor incentive problem because a well-designed incentive scheme has the potential to greatly improve the network (we will discuss several technical designs below). However, because of the many open social questions, it has been challenging for the Tor community to come to a consensus on the path forward. On one hand and as discussed above, many people already run Tor relays and provide valuable service, and the &lt;a href=&quot;https://metrics.torproject.org/network.html#networksize&quot;&gt;network&lt;/a&gt; and &lt;a href=&quot;https://metrics.torproject.org/network.html#bandwidth&quot;&gt;bandwidth&lt;/a&gt; graphs imply some amount of success in network growth. It would be tragic if the introduction of an experimental reward scheme drove away the existing participants. On the other hand, the &lt;a href=&quot;https://metrics.torproject.org/users.html#userstats-relay-country&quot;&gt;number of Tor clients still vastly exceeds the number of relays&lt;/a&gt;, and Tor’s bandwidth capacity remains the limiting factor for Tor’s growth. &lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;reasoning_model&quot; href=&quot;#reasoning_model&quot;&gt;A simplified model of reasoning&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If we consider that relay operators with a higher intrinsic motivation to contribute are somehow more desirable to the network and the community because they care more deeply about Tor and the social movement, then we can consider there to be a trade-off between reward value and the desirability of the operator. The lower the extrinsic reward value is, the higher the intrinsic value a potential new operator must possess in order for the total value to be high enough to motivate her to contribute. The higher the extrinsic reward value is, the lower the intrinsic value may be to still attract the new operator. Under this model, as the value of the reward increases, the number of individuals willing to contribute also increases while their &quot;quality&quot; decreases.&lt;/p&gt;
&lt;p&gt;Please note that this is a very simplified model of reasoning and since it does not necessarily reflect reality, not everyone should agree with it. There are many other values in play here as well; for example, motivations change over time as the world changes, and incentive schemes that require significant protocol modifications are more difficult to implement, test, and deploy. Nonetheless, this simplified model may help sort out the issues, and it seems to be consistent with the fact that the Tor community has thus far preferred to grow the network through intrinsically motivated relay operators.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;social_rewards&quot; href=&quot;#social_rewards&quot;&gt;Social rewards&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Tor’s volunteer approach has generally been on the conservative side of our simplified model, where individuals with higher intrinsic motivations to contribute to Tor are preferred. New operators have been recruited through social and community-oriented efforts such as explaining how great Tor is and why they should care. This works well for people who are already intrinsically motivated about Tor, such as &lt;a href=&quot;http://imgur.com/sZUKADG&quot;&gt;this guy who tattooed a Tor onion on his arm&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Other relay recruitment approaches for intrinsically motivated individuals include &lt;a href=&quot;https://www.torservers.net/&quot;&gt;Torservers.net&lt;/a&gt; and the &lt;a href=&quot;https://www.noisebridge.net/wiki/Tor&quot;&gt;Noisebridge Tor Exit Node Project&lt;/a&gt;: both operate as independent nonprofit organizations for those people who would like to contribute to the Tor network but for one reason or another are not in a position to operate relays themselves. As discussed in a &lt;a href=&quot;https://blog.torproject.org/blog/support-tor-network-donate-exit-node-providers&quot;&gt;2011 post&lt;/a&gt;, it is preferable that people who can run their own fast exit relays do so. But the approach of turning donations into fast exit capacity allows those who cannot run their own relays to still contribute to improving the performance and exit capacity of the Tor network.&lt;/p&gt;
&lt;p&gt;The more recent &lt;a href=&quot;https://www.eff.org/torchallenge/&quot;&gt;EFF Tor Challenge&lt;/a&gt; is somewhere on the same side of the spectrum, except it actually offers small rewards as incentives. EFF explains Tor’s importance and users are encouraged to contribute to the network by running a relay. The challenge offers prizes to relay operators as an incentive: name and twitter handle published in a list of contributors, a limited edition sticker for running a relay for 12 months, and a t-shirt if that relay is fast (bandwidth of 1 MB/s or larger after 12 months).&lt;/p&gt;
&lt;p&gt;Other social rewards are possible here as well. A &lt;a href=&quot;https://lists.torproject.org/pipermail/tor-dev/2014-June/006975.html&quot;&gt;post on the tor-dev mailing list&lt;/a&gt; proposes that Tor host a simple profile page for each relay that will list and celebrate the relay’s total bandwidth contribution over time, and recognize the operator for running special Tor bridge or exit relays. Relatively simple ideas like this may have the potential to attract intrinsically-motivated individuals without requiring extrinsic rewards or a lot of changes to Tor itself.&lt;/p&gt;
&lt;p&gt;The approaches in this category are relatively low-risk/low-reward schemes: even though the new operators are receiving recognition or a reward for running a relay, the reward is of such little value that there is little risk that existing contributors who may not have been rewarded will leave. At the same time, a new operator loses little if it decides to shut down the new relay.&lt;/p&gt;
&lt;p&gt;On the other side of the spectrum are more &quot;radical&quot; approaches that do not require individuals with high intrinsic motivation (though they are welcome, too!) but change Tor’s design have been explored by researchers. Researchers explore these designs because they are generally more technically interesting and have the potential to produce a much larger set of relays. We now shift to discussing these latest research proposals.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;research_review&quot; href=&quot;#research_review&quot;&gt;Review of early research on Tor incentive system designs - Gold Star and PAR&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.torproject.org/blog/two-incentive-designs-tor&quot;&gt;The 2009 post&lt;/a&gt; discussed two incentive papers that were new at the time: &lt;a href=&quot;http://cs.gmu.edu/~astavrou/research/Par_PET_2008.pdf&quot;&gt;Payment for Anonymous Routing&lt;/a&gt; from PETS 2008 (PAR) and &lt;a href=&quot;http://freehaven.net/anonbib/papers/incentives-fc10.pdf&quot;&gt;Building Incentives into Tor&lt;/a&gt; from FC 2010 (the &quot;Gold Star&quot; scheme).&lt;/p&gt;
&lt;p&gt;In the Gold Star scheme, the Tor directory authorities measure the bandwidth of Tor relays and assign a special flag (a &quot;gold star&quot;) to the fastest 7/8 of relays. Then whenever those relays send traffic through Tor, they choose the other fast gold star relays to form a fast gold star path. Relays then prioritize traffic on these gold star paths. The incentive here is that if you run a relay, you will get faster service when using Tor as a client. The main drawback to this approach is that only relays are able to get gold stars and priority service. This means that all relays that are part of a gold star path know for certain that the initiator of that traffic is someone from the small list of gold star relays. Because the set of gold star relays would be smaller than the set of all Tor users by several orders of magnitude, the anonymity for gold star relays would be significantly harmed.&lt;/p&gt;
&lt;p&gt;In PAR, all users (not just relays) are able to be part of the incentive system. PAR has an honest-but-curious centralized entity called a &quot;bank&quot; that manages digital tokens called &quot;coins&quot;. Users can purchase coins from the bank and then pay the relays while using Tor; the relays then deposit the coins back into the bank and the bank checks to make sure the coin is valid and that it has never been spent before (i.e., it has not been &quot;double spent&quot;). The main novel idea explored in this work is how to include digital payments into each Tor circuit in a way that prevents the relays from learning the client’s identity from the payment itself.&lt;/p&gt;
&lt;p&gt;Adding real money into Tor opens a host of new legal and technical questions, which &lt;a href=&quot;https://blog.torproject.org/blog/two-incentive-designs-tor&quot;&gt;Roger already briefly discussed&lt;/a&gt;. For example, real money might shift Tor into a different legal category (see e.g. the EU discussions of what is a &quot;service provider&quot; and which ones are obliged to do data retention), or change the liability situation for relay operators.&lt;/p&gt;
&lt;p&gt;The main design challenge we learned from the PAR design is that the timing of when the client withdraws the coins and the relays deposit them creates a trade-off between the ability to detect double spending and link a client to its coins. If the client withdraws some coins and a few seconds later a relay starts depositing coins, how much information does the bank gain? If the relay waits for some time interval to deposit the coins to hide this timing information, then it becomes possible for the client to double spend those coins during that interval. The longer the relay waits before depositing, the harder it is for the bank to link the coins but the easier it is for the client to cheat. A rational relay will deposit immediately to secure its payment, which leads to the worst situation for anonymity. If we assume the relays will deposit immediately, then it is up to the client to hold coins for some random amount of time after purchasing them from the bank, to disrupt potential attempts to link withdrawals to deposits at the cost of flexibility in usage.&lt;/p&gt;
&lt;p&gt;In review, both of these proposals have anonymity problems: the Gold Star scheme because the assignment of rewards to relays is public and identifies traffic as originating from the relatively small set of clients of fast relay operators; and PAR because the timing of the withdrawal by the client and the deposit by the relay may leak information about the client’s traﬃc. In PAR, coins may be held by the client and the relay longer to disrupt this timing information, but this trades off flexibility in usage and the speed at which double spending can be detected. So what have these papers taught us? We have learned about some requirements that a Tor incentive scheme should probably fulfill: both clients and relays should be able to receive the incentive so that neither group stands out; and the timing of payments should not allow cheating and should not enable linkability. &lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;prevent_doublespend_timing&quot; href=&quot;#prevent_doublespend_timing&quot;&gt;Preventing double-spending without leaking timing information - BRAIDS&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.robgjansen.com/publications/braids-ccs2010.pdf&quot;&gt;Recruiting New Tor Relays with BRAIDS&lt;/a&gt; was the followup research proposal presented at CCS in 2010. One of our goals in BRAIDS was to eliminate the trade-off between double-spending and linkability. To achieve this, we designed a new type of digital token which we called a &quot;relay-specific ticket&quot;. Tickets were still issued by a trusted, centralized entity - the ticketmaster (we called it a &quot;bank&quot; in the paper, but BRAIDS was not designed to handle real money). Clients choose which relays they want to use, and receive tickets from the ticketmaster that are valid only at the chosen relays while hiding the chosen relay information from the ticketmaster (using partially-blind signatures). Clients then form a Tor circuit with the chosen relays and send the tickets to receive traffic priority (using a differentiated services scheduler). Each ticket will then provide traffic priority through the chosen relay for a specific number of bytes. Because each ticket a relay receives is only valid at that relay and no other, the relay could prevent double spending locally without contacting the ticketmaster.&lt;/p&gt;
&lt;p&gt;Another feature of BRAIDS is that tickets are distributed freely in small amount to any client that asks, but only to one client per IP address, and only once per distribution round. If the clients change their mind about which relays they want to use for a circuit, they may contact the ticketmaster to exchange their old tickets for new ones following a time schedule. The exchange process is also used by relays to turn the tickets they received from clients into new usable tickets.&lt;/p&gt;
&lt;p&gt;One main drawback to BRAIDS is that even though all users are able to get a small amount of tickets for free, relays are able to accumulate a much larger stash because they receive the free tickets AND the tickets sent to them by other clients. This means that relays stand out when using tickets to download large flows because it is less likely that a normal client would have been able to afford it. Another major drawback is that the exchange process is somewhat inefficient. Relays will exchange received tickets for new ones which they can use themselves, and clients that didn't spend their tickets (e.g., because their Tor usage was low or their chosen relays became unavailable) must exchange them or lose them. This leads to the ticketmaster exchanging all system tickets over every exchange interval. (The ticket validity interval is split into [spend, relay exchange, client exchange], so clients that don't spend in the &quot;spend&quot; time-frame must wait until &quot;client exchange&quot; time-frame to get new tickets. Increasing the interval lengths make them slightly less flexible to rapid changes. The longer the intervals, the more tickets will &quot;pile up&quot; for later processing by the ticketmaster.)&lt;/p&gt;
&lt;p&gt;BRAIDS showed us the power of relay-specific tickets but unveiled the scalability problems associated with a trusted, centralized entity.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;improving_scalability&quot; href=&quot;#improving_scalability&quot;&gt;Improving scalability - LIRA&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.robgjansen.com/publications/lira-ndss2013.pdf&quot;&gt;LIRA: Lightweight Incentivized Routing for Anonymity&lt;/a&gt; was published at NDSS 2013. LIRA still uses a centralized entity to manage the incentives, but LIRA only requires incentive management for the relays (thousands) instead of for all system users (millions) like BRAIDS. The way we achieve this is through the use of a lottery system, where clients could simply guess a random number for every circuit to receive priority on that circuit (traffic is prioritized using a differentiated services scheduler as in BRAIDS) with tunable probability. The lottery is set up with special &lt;a href=&quot;http://mit.tv/wHGsAp&quot;&gt;cryptography magic&lt;/a&gt; such that relays are rewarded with guaranteed winning guesses to the lottery; relays are allotted winners according to the amount of bandwidth they contributed.&lt;/p&gt;
&lt;p&gt;LIRA is more efficient and scalable than any earlier scheme. However, LIRA’s main drawback is that probabilistic guessing reduces flexibility for clients wanting to receive continuous priority over time, and creates a potential for cheating the system because it enables clients to continuously create new circuits and new guesses until a correct guess is found. Another problem is that a secure bandwidth measurement scheme is required to ensure that relays don’t receive rewards without actually contributing to Tor (this wasn't necessary in BRAIDS because the clients sent rewards (tickets) directly to the relays); secure bandwidth measurement is still an open research problem. Finally, LIRA still relies on a trusted central entity to manage the lottery.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;reducing_trust_requirements&quot; href=&quot;#reducing_trust_requirements&quot;&gt;Reducing reliance on trusted parties - TEARS&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.robgjansen.com/publications/tears-hotpets2014.pdf&quot;&gt;From Onions to Shallots: Rewarding Tor Relays with TEARS&lt;/a&gt; will be presented at HotPETs later this week. The main goal in TEARS is to remove the reliance on a central entity to manage the incentives. The central entities in the above schemes (let’s generalize them as &quot;banks&quot;) are referred to as &quot;semi-trusted&quot;, because there are several ways a malicious bank could misbehave - for example, the bank could refuse service, could extort users by demanding extra fees in order to process their requests, or could &quot;inflate&quot; the digital currency (coins, tickets, guesses, etc.) by printing its own tokens for a profit.&lt;/p&gt;
&lt;p&gt;TEARS draws upon the decentralized Bitcoin design to address these concerns by using a &lt;b&gt;*publicly auditable*&lt;/b&gt; e-cash protocol that prevents the bank from misbehaving and getting away with it. The bank in TEARS consists of a group of semi-trusted servers, such as the Tor directory servers (as opposed to Bitcoin’s distributed proof-of-work lottery), only a quorum of which need to function correctly for the overall system to keep working. The e-cash cryptography used here is publicly auditable and every interaction with the bank is conducted over a public communication channel (such as the Bitcoin blockchain itself). The security guarantee is that any form of misbehavior on the part of the bank servers leaves a trail of evidence that can be discovered by anyone watching. This approach is reminiscent of systems like &lt;a href=&quot;http://www.certificate-transparency.org/&quot;&gt;Certificate Transparency&lt;/a&gt; and &lt;a href=&quot;http://opentransactions.org&quot;&gt;OpenTransactions.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In addition to a decentralized bank, TEARS offers a new two-level token architecture to facilitate rewarding relays for their bandwidth contributions without hurting anonymity. First, a decentralized process audits relays’ bandwidth and informs the bank of the results. The bank mints new &quot;shallots&quot; (anonymous, auditable e-cash) for each relay based on their contributions and deposits them into the relay accounts on their behalf. Separately, the bank’s monetary policy may allow it to mint new shallots and distribute them to users, e.g. using mechanisms suggested in BRAIDS but more commonly known to Bitcoin users as &lt;a href=&quot;https://en.bitcoin.it/wiki/Bitcoin_faucet&quot;&gt;faucets&lt;/a&gt;. Second, shallots are transferable among users and may be redeemed for relay-specific &quot;PriorityPasses&quot;, which are then used to request traffic priority from Tor relays (again, as in BRAIDS). PriorityPasses are relay-specific so that relays can immediately and locally prevent double spending without leaking information to any other entity. This is a similar feature present in BRAIDS’ tickets. However, a novel feature of PriorityPasses is that they are non-transferable and become useless after being spent at a relay -- this reduces overhead associated with exchanges, and ensures that the process of requesting traffic priority does not harm anonymity because the act of redeeming a shallot for a PriorityPass will be unlinkable to any later transaction. There is a question of how many PriorityPasses can be spent in one circuit before it is suspicious that a client has so many, so the size of the faucets and how they distribute Shallots will play a key role in anonymity. Anonymity is also tied to how relays decide to distribute their Shallots to clients, either via a faucet or a through a third party market.&lt;/p&gt;
&lt;p&gt;TEARS was designed to operate inside the existing Tor network and thus does not significantly change the fundamentals of Tor’s design. The decentralized bank and bandwidth measurement components do not alter the way clients choose circuits. Clients and relays that want to use or support TEARS, however, would need to support new protocols for interacting with the bank and logic for handling shallots, PriorityPasses, and traffic priority.&lt;/p&gt;
&lt;p&gt;TEARS still relies on a &quot;bandwidth measuring&quot; component that can accurately and robustly determine when a relay has indeed contributed useful bandwidth. While the e-cash system in TEARS is designed to be publicly auditable, the existing mechanisms for bandwidth still require trusted authorities to probe. &lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;bandwidth_measurement&quot; href=&quot;#bandwidth_measurement&quot;&gt;Bandwidth measurement - TorCoin&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;http://www.robgjansen.com/publications/torpath-hotpets2014.pdf&quot;&gt;A TorPath to TorCoin - Proof-of-Bandwidth Altcoins for Compensating Relays&lt;/a&gt; is the other paper to be presented at HotPETs this week. TorCoin addresses the bandwidth measurement problem with a different approach -- an altcoin (a Bitcoin alternative) based on a novel &quot;proof-of-bandwidth&quot; (rather than proof-of-work) mechanism called TorPath, in which the relays (and endpoints) of a circuit effectively mine for new coins whenever they successfully transfer a batch of packets. In TorCoin, a group of &quot;assignment&quot; authorities are responsible for generating a list of circuits (using a shuffle protocol) and assigning them to clients. Bandwidth proofs are then constructed as the circuit is used such that the client mines the TorCoin and then transfers part of it to each of the circuit’s participants.&lt;/p&gt;
&lt;p&gt;Like TEARS, TorCoin distributes the process of rewarding relays for their bandwidth contributions. Bandwidth measurement is done directly as part of the distributed mining process and provides strong guarantees. Also, by utilizing a group of assignment authorities that may have more information about the system or underlying network, there is a lot of potential for generating more secure paths for clients than clients are able to generate for themselves.&lt;/p&gt;
&lt;p&gt;TorCoin still has some issues to work out; it may be possible to fix some of the smaller issues with protocol modifications, but some of the larger issues don’t have obvious solutions.&lt;/p&gt;
&lt;p&gt;One drawback to TorCoin is that it requires the group of collectively-trusted assignment authorities (you have to trust only that some threshold/quorum number of them are correct) to generate and assign circuits to clients. This is a similar trust model to the current Tor directory authorities. In practice, the assignment authorities cause availability issues: if a majority of the assignment authorities are unreachable, e.g. due to DoS or censorship, then the system is unusable to the clients because they won’t be able to generate circuits. This is also somewhat true of the directory authorities, however, directory information can be signed and then mirrored and distributed by other relays in the system whereas assignment authorities are required to always be online and available to new clients. TorCoin clients contact the assignment authorities in order to build new circuits, whereas in Tor they can build as many circuits as they need once the directory information is retrieved (from the directory auths or from directory mirrors).&lt;/p&gt;
&lt;p&gt;TorCoin as written has significant security issues. Because relay assignment is not based on bandwidth, it is easier for an adversary to get into the first and last position on a circuit and break anonymity. This can be done through a sybil attack by adding an arbitrary number of bad relays and joining them to the network without actually providing bandwidth. Because the protocol reveals  which ephemeral keys are attached to the assigned circuits, an adversary can confirm when it has compromised a circuit (has malicious nodes in the correct positions) without needing to do any statistical correlation attack (it can match up the ephemeral keys assigned to its malicious relays to the ones posted in the circuit assignment list). &lt;/p&gt;
&lt;p&gt;The formation of relay/client groups is not discussed and is similarly vulnerable to sybil attacks where the adversary can completely subvert the coin mining process. This can be done by registering an arbitrary number of relays and clients with the assignment servers, such that a large majority of circuits created by the assignment process will contain malicious relays in all positions and be assigned to a malicious client. This malicious collective of nodes can then “pretend” to send bytes through the circuit without actually doing so, and gain an advantage when mining coins. The paper suggests to use a persistent guard, which means the adversary only needs malicious relays in the middle and exit positions of its sybil client circuits, exponentially increasing the probability of a full compromise (or requiring far fewer nodes to achieve the same probability of compromise as without persistent guards). (The sybil clients only have to get 2 of its relays in the circuit instead of 3, reducing the probability from f^3 to f^2 for malicious fraction f.) Further, even if some relays on a circuit are honest, it is not rational for them to refuse to sign proofs of bandwidth that have been exaggerated (too high) by other relays. It will only benefit a relay to ignore proof-of-bandwidth checks, giving it an advantage over completely honest nodes in the TorCoin mining process.&lt;/p&gt;
&lt;p&gt;There are a variety of unaddressed practical deployment issues as well. It is not clear how to do load balancing with TorCoin alone - no one should be able to determine how many bytes were sent by any of the circuit members or where the payments for mined coins are being sent (anonymous TorCoin transactions are necessary for anonymity). Exit policies are not discussed, and there is no clear way to support them and for a client that would like to request a specific exit port. Its not clear how to ensure that a relay is not chosen for the same circuit twice, or two relays from the same relay family are not on the same circuit. Finally, it is not clear how to link ephemeral circuit keys to TorCoin addresses so that payments may be sent from clients to relays without revealing client identity.&lt;/p&gt;
&lt;p&gt;Don't misunderstand my ranting here - I think that the TorCoin idea is great (I am a co-author after all). It has the potential to motivate new researchers and developers to start thinking about solutions to problems that Tor is interested in, particularly bandwidth measurement. However, the limitations need to be clear so that we don't start seeing production systems using it and claiming to provide security without working through &lt;b&gt;*at least*&lt;/b&gt; the issues mentioned above. The current paper was an initial concept in its early stages, and I expect the system to improve significantly as it is furthered developed.&lt;/p&gt;
&lt;p&gt;(For completeness, we should also point out that TorCoin will need a new name if anybody decides to build it. The &lt;a href=&quot;https://www.torproject.org/docs/trademark-faq#researchpapers&quot;&gt;Tor trademark faq&lt;/a&gt; says it's fine for research paper designs to use the Tor mark, but if it becomes actual software then it sure will be confusing to users and the rest of the Tor community about whether it's written by or endorsed by Tor.)&lt;/p&gt;
&lt;p&gt;Note that TorCoin and TEARS are at least somewhat complementary, since TEARS &lt;b&gt;*needs*&lt;/b&gt; a proof-of-bandwidth scheme, and TorCoin &lt;b&gt;*provides*&lt;/b&gt; one. However, they’re also not directly compatible. TorCoin requires a substantial change to both Bitcoin and to Tor (or to put it another way, it would be a system that only partially resembles Bitcoin and only partially resembles Tor). On the other hand, TEARS leaves Tor's circuit-finding mechanism intact, and the token protocol in TEARS is closer to traditional anonymous e-cash systems than to Bitcoin.&lt;/p&gt;
&lt;h2&gt;&lt;a id=&quot;better_or_worse&quot; href=&quot;#better_or_worse&quot;&gt;For better or for worse?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As outlined above, recent research has made great improvements in the area of Tor incentives. More work is needed to show the feasibility and efficiency of the decentralized approaches, and a secure bandwidth measurement scheme would help fill a critical piece missing from TEARS. Recent improvements to the way Tor schedules sockets and circuits would be necessary to correctly provide traffic priority (see &lt;a href=&quot;https://trac.torproject.org/projects/tor/ticket/12541&quot;&gt;#12541&lt;/a&gt;), and then a differentiated services scheduler that is able to prioritize traffic by classes (already described in and prototyped for the BRAIDS, LIRA, and TEARS papers) would also be needed.&lt;/p&gt;
&lt;p&gt;Unfortunately, it is unclear how to make headway on the social issues. A small scale rollout of an &quot;experimental build&quot; to those relays who want to support new incentive features could be one way to test a new approach without committing to anything long term.&lt;/p&gt;
&lt;p&gt;One question that is often raised is: if an incentive scheme rewards relays for providing bandwidth, then won’t everyone just pick the same cheapest hosting provider and Tor will lose location diversity? This question is largely addressed in the discussion of what constitutes a useful service in the TEARS paper (the TEARS paper and appendices also gives useful commentary on many of the common problems and design decisions to make when designing an incentive scheme). Basically, it can be addressed in the monetary policy, e.g., in addition to rewarding relays for bandwidth, the bank could also assign weights that could be used to adjust the rewards based on certain flags that relays possess, or the geographic location in which they operate. This could be adjusted over time so that there would be a higher incentive to run relays in parts of the world where none exist, or to prefer exit relays over other positions, etc. Although, note that it is unclear exactly what the &quot;correct&quot; utility function should be and when/how it should be adjusted. Note that &lt;a href=&quot;https://www.torservers.net/&quot;&gt;Torservers.net&lt;/a&gt; similarly rewards relays for location diversity (&lt;a href=&quot;https://blog.torservers.net/20140610/reimbursement-report-2014-05.html&quot;&gt;see here&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Another point to make here is that most of these approaches have nothing to do with giving out or transferring real dollars. The tokens in most of these schemes are useful only to receive traffic priority in Tor. Will there be third party markets that form around the exchange of the tokens? Sure. And they may be speculated. But at the end of the day, the tokens would still only provide prioritized traffic. Depending on the configuration of the priority scheduler, the difference between priority traffic and normal traffic may not be that extreme. It is conceivable that the tokens would not be worth nearly enough to compensate an operator for the ISP connection, much less the overhead involved with updating the software, maintaining the machine, and talking with the ISP -- and in that case we are still on the more conservative side of the social incentive discussions above.&lt;/p&gt;
&lt;p&gt;Tor has some choices to make in terms of how to grow the network and how to position the community during that growth process. I hope that this post, and the research presented herein, will at least help the community understand some of the options that are available.&lt;/p&gt;
&lt;p&gt;All the best, ~&lt;a href=&quot;http://www.robgjansen.com&quot;&gt;Rob&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[Thanks to Roger Dingledine, Bryan Ford, Aaron Johnson, Andrew Miller, and Paul Syverson for input and feedback on this post.]&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="tor" /><category term="performance" /><category term="incentives" /><category term="bitcoin" /><summary>This post originally appeared on the TorProject blog summarizing the then-current state of research on Tor incentive schemes and related challenges. The post includes information about the new TorCoin and TEARS research papers that appeared at HotPETs later that week.</summary></entry><entry><title>paper accepted to USENIX Security 2014</title><link href="/blog/2014/05/27/paper-accepted-to-usenix-security-2014/" rel="alternate" type="text/html" title="paper accepted to USENIX Security 2014" /><published>2014-05-27T22:22:13-04:00</published><updated>2014-05-27T22:22:13-04:00</updated><id>/blog/2014/05/27/paper-accepted-to-usenix-security-2014</id><content type="html" xml:base="/blog/2014/05/27/paper-accepted-to-usenix-security-2014/">&lt;p&gt;Our paper entitled “&lt;a href=&quot;/publications/kist-sec2014.pdf&quot;&gt;Never Been KIST: Tor’s Congestion Management Blossoms with Kernel-Informed Socket Transport&lt;/a&gt;” has been &lt;del&gt;conditionally accepted upon shepherd approval&lt;/del&gt; accepted to USENIX Security 2014!&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="publication" /><summary>Our paper entitled “Never Been KIST: Tor’s Congestion Management Blossoms with Kernel-Informed Socket Transport” has been conditionally accepted upon shepherd approval accepted to USENIX Security 2014!</summary></entry><entry><title>papers accepted to HotPETs 2014</title><link href="/blog/2014/05/27/papers-accepted-to-hotpets-2014/" rel="alternate" type="text/html" title="papers accepted to HotPETs 2014" /><published>2014-05-27T22:16:10-04:00</published><updated>2014-05-27T22:16:10-04:00</updated><id>/blog/2014/05/27/papers-accepted-to-hotpets-2014</id><content type="html" xml:base="/blog/2014/05/27/papers-accepted-to-hotpets-2014/">&lt;p&gt;Two of our submissions about integrating BitCoin and Tor were accepted to HotPETs 2014!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;/publications/tears-hotpets2014.pdf&quot;&gt;From Onions to Shallots: Rewarding Tor Relays with TEARS&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/publications/torpath-hotpets2014.pdf&quot;&gt;A TorPath to TorCoin: Proof-of-Bandwidth Altcoins for Compensating Relays&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="publication" /><summary>Two of our submissions about integrating BitCoin and Tor were accepted to HotPETs 2014!</summary></entry><entry><title>static site generator</title><link href="/blog/2014/04/21/static-site-generator/" rel="alternate" type="text/html" title="static site generator" /><published>2014-04-21T23:16:47-04:00</published><updated>2014-04-21T23:16:47-04:00</updated><id>/blog/2014/04/21/static-site-generator</id><content type="html" xml:base="/blog/2014/04/21/static-site-generator/">&lt;p&gt;My website is produced using the &lt;a href=&quot;http://octopress.org/&quot;&gt;Octopress&lt;/a&gt; blogging framework, a static site generator that turns &lt;a href=&quot;https://daringfireball.net/projects/markdown/&quot;&gt;markdown&lt;/a&gt; into html pages, and is backed by a git repository. I can write a new post by simply pushing a new markdown file to the repository. I recommend Octopress as it’s very convenient and nerd friendly!&lt;/p&gt;</content><author><name>robgjansen</name></author><summary>My website is produced using the Octopress blogging framework, a static site generator that turns markdown into html pages, and is backed by a git repository. I can write a new post by simply pushing a new markdown file to the repository. I recommend Octopress as it’s very convenient and nerd friendly!</summary></entry><entry><title>news feature now active</title><link href="/blog/2014/04/21/news-feature-now-active/" rel="alternate" type="text/html" title="news feature now active" /><published>2014-04-21T22:00:05-04:00</published><updated>2014-04-21T22:00:05-04:00</updated><id>/blog/2014/04/21/news-feature-now-active</id><content type="html" xml:base="/blog/2014/04/21/news-feature-now-active/">&lt;p&gt;I just changed the blogging feature into a news section, and plan to submit news items via this channel. Sweet.&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><summary>I just changed the blogging feature into a news section, and plan to submit news items via this channel. Sweet.</summary></entry><entry><title>New Tor Denial of Service Attacks and Defenses</title><link href="/blog/2014/01/24/new-tor-denial-of-service-attacks-and-defenses/" rel="alternate" type="text/html" title="New Tor Denial of Service Attacks and Defenses" /><published>2014-01-24T15:42:00-05:00</published><updated>2014-01-24T15:42:00-05:00</updated><id>/blog/2014/01/24/new-tor-denial-of-service-attacks-and-defenses</id><content type="html" xml:base="/blog/2014/01/24/new-tor-denial-of-service-attacks-and-defenses/">&lt;blockquote&gt;
  &lt;p&gt;This post originally appeared &lt;a href=&quot;https://blog.torproject.org/blog/new-tor-denial-service-attacks-and-defenses&quot;&gt;on the TorProject blog&lt;/a&gt; summarizing our “Sniper Attack” publication.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;New work on denial of service in Tor will be presented at &lt;a href=&quot;http://www.internetsociety.org/ndss2014/programme#session5&quot;&gt;NDSS '14 on Tuesday, February 25th, 2014&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;cite&gt;&lt;br /&gt;
&lt;b&gt;The Sniper Attack: Anonymously Deanonymizing and Disabling the Tor Network&lt;/b&gt;&lt;br /&gt;
by Rob Jansen, Florian Tschorsch, Aaron Johnson, and Björn Scheuermann&lt;br /&gt;
To appear at the 21st Symposium on Network and Distributed System Security&lt;br /&gt;
&lt;/cite&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.robgjansen.com/publications/sniper-ndss2014.pdf&quot;&gt;A copy of the published paper is now available&lt;/a&gt;, as are my slides explaining the attacks in both &lt;a href=&quot;http://www.robgjansen.com/talks/sniper-dcaps-20131011.pptx&quot;&gt;PPTX&lt;/a&gt; and &lt;a href=&quot;http://www.robgjansen.com/talks/sniper-dcaps-20131011.pdf&quot;&gt;PDF&lt;/a&gt; formats.&lt;/p&gt;
&lt;p&gt;We found a new vulnerability in the design of Tor's flow control algorithm that can be exploited to remotely crash Tor relays. The attack is an extremely &lt;b&gt;low resource&lt;/b&gt; attack in which an adversary's bandwidth may be traded for a target relay's memory (RAM) at an amplification rate of one to two orders of magnitude. Ironically, the adversary can use Tor to protect it's identity while attacking Tor without significantly reducing the effectiveness of the attack.&lt;/p&gt;
&lt;p&gt;We studied &lt;b&gt;relay availability&lt;/b&gt; under the attack using &lt;a href=&quot;https://shadow.github.io/&quot;&gt;Shadow&lt;/a&gt;, a discrete-event network simulator that runs the real Tor software in a safe, private testing environment, and found that we could disable each of the fastest guard and the fastest exit relay in a range of 1-18 minutes (depending on relay RAM capacity). We also found that the entire group of the top 20 exit relays, representing roughly 35% of Tor bandwidth capacity at the time of the analysis, could be disabled in a range of 29 minutes to 3 hours and 50 minutes. We also analyzed how the attack could potentially be used to &lt;b&gt;deanonymize&lt;/b&gt; hidden services, and found that it would take between 4 and 278 hours before the attack would succeed (again depending on relay RAM capacity, as well as the bandwidth resources used to launch the attack).&lt;/p&gt;
&lt;p&gt;Due to our devastating findings, we also designed three defenses that mitigate our attacks, one of which provably renders the attack ineffective. Defenses have been implemented and deployed into the Tor software to ensure that &lt;b&gt;the Tor network is no longer vulnerable as of Tor version 0.2.4.18-rc and later&lt;/b&gt;. Some of that work can be found in Trac tickets &lt;a href=&quot;https://trac.torproject.org/projects/tor/ticket/9063&quot;&gt;#9063&lt;/a&gt;, &lt;a href=&quot;https://trac.torproject.org/projects/tor/ticket/9072&quot;&gt;#9072&lt;/a&gt;, &lt;a href=&quot;https://trac.torproject.org/projects/tor/ticket/9093&quot;&gt;#9093&lt;/a&gt;, and &lt;a href=&quot;https://trac.torproject.org/projects/tor/ticket/10169&quot;&gt;#10169&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In the remainder of this post I will detail the attacks and defenses we analyzed, noting again that this information is presented more completely (and more elegantly) in &lt;a href=&quot;http://www.robgjansen.com/publications/sniper-ndss2014.pdf&quot;&gt;our paper&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;

&lt;h1&gt;The Tor Network Infrastructure&lt;/h1&gt;
&lt;p&gt;The Tor network is a distributed system made up of thousands of computers running the Tor software that contribute their bandwidth, memory, and computational resources for the greater good. These machines are called Tor &lt;b&gt;relays&lt;/b&gt;, because their main task is to forward or relay network traffic to another entity after performing some cryptographic operations. When a Tor user wants to download some data using Tor, the user's Tor client software will choose three relays from those available (an &lt;b&gt;entry&lt;/b&gt;, &lt;b&gt;middle&lt;/b&gt;, and &lt;b&gt;exit&lt;/b&gt;), form a path or &lt;b&gt;circuit&lt;/b&gt; between these relays, and then instruct the third relay (the exit) to fetch the data and send it back through the circuit. The data will get transferred from its source to the exit, from the exit to the middle, and from the middle to the entry before finally making its way to the client.&lt;/p&gt;
&lt;h1&gt;Flow Control&lt;/h1&gt;
&lt;p&gt;The client may request the exit to fetch large amounts of data, and so Tor uses a window-based &lt;a href=&quot;http://en.wikipedia.org/wiki/Flow_control_%28data%29&quot;&gt;flow control&lt;/a&gt; scheme in order to limit the amount of data each relay needs to buffer in memory at once. When a circuit is created, the exit will initialize its circuit &lt;b&gt;package&lt;/b&gt; counter to 1000 cells, indicating that it is willing to send 1000 cells into the circuit. The exit decrements the package counter by one for every data cell it sends into the circuit (to the middle relay), and stops sending data when the package counter reaches 0. The client at the other end of the circuit keeps a &lt;b&gt;delivery&lt;/b&gt; counter, and initializes it to 0 upon circuit creation. The client increments the delivery counter by 1 for every data cell it receives on that circuit. When the client's delivery counter reaches 100, it sends a special Tor control cell, called a SENDME cell, to the exit to signal that it received 100 cells. Upon receiving the SENDME, the exit adds 100 to its package counter and continues sending data into the circuit.&lt;/p&gt;
&lt;p&gt;This flow control scheme limits the amount of outstanding data that may be in flight at any time (between the exit and the client) to 1000 cells, or about 500 KiB, per circuit. The same mechanism is used when data is flowing in the opposite direction (up from the client, through the entry and middle, and to the exit).&lt;/p&gt;
&lt;h1&gt;The Sniper Attack&lt;/h1&gt;
&lt;p&gt;The new Denial of Service (DoS) attack, which we call &lt;b&gt;&quot;The Sniper Attack&quot;&lt;/b&gt;, exploits the flow control algorithm to remotely crash a victim Tor relay by depleting its memory resources. The paper presents three attacks that rely on the following two techniques:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt; the attacker &lt;b&gt;stops reading from the TCP connection containing the attack circuit&lt;/b&gt;, which causes the TCP window on the victim's outgoing connection to close and the victim to buffer up to 1000 cells; and&lt;/li&gt;
&lt;li&gt; the attacker causes cells to be continuously sent to the victim (exceeding the 1000 cell limit and consuming the victim's memory resources) either by &lt;b&gt;ignoring the package window at packaging end&lt;/b&gt; of the circuit, or by &lt;b&gt;continuously sending SENDMEs from the delivery end&lt;/b&gt; to the packaging end even though no cells have been read by the delivery end.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
I'll outline the attacks here, but remember that the &lt;a href=&quot;http://www.robgjansen.com/publications/sniper-ndss2014.pdf&quot;&gt;paper&lt;/a&gt; and &lt;a href=&quot;http://www.robgjansen.com/talks/sniper-dcaps-20131011.pdf&quot;&gt;slides&lt;/a&gt; provide more details and useful illustrations of each of the three versions of the attack.&lt;/p&gt;
&lt;h2&gt;Basic Version 1 (attacking an entry relay)&lt;/h2&gt;
&lt;p&gt;In basic version 1, the adversary controls the client and the exit relay, and chooses a victim for the entry relay position. The adversary builds a circuit through the victim to her own exit, and then the exit continuously generates and sends arbitrary data through the circuit toward the client while ignoring the package window limit. The client stops reading from the TCP connection to the entry relay, and the entry relay buffers all data being sent by the exit relay until it is killed by its OS out-of-memory killer.&lt;/p&gt;
&lt;h2&gt;Basic Version 2 (attacking an exit relay)&lt;/h2&gt;
&lt;p&gt;In basic version 2, the adversary controls the client and an Internet destination server (e.g. website), and chooses a victim for the exit relay position. The adversary builds a circuit through the victim exit relay, and then the client continuously generates and sends arbitrary data through the circuit toward the exit relay while ignoring the package window limit. The destination server stops reading from the TCP connection to the exit relay, and the exit relay buffers all data being sent by the client until it is killed by its OS out-of-memory killer.&lt;/p&gt;
&lt;h2&gt;Efficient Version&lt;/h2&gt;
&lt;p&gt;Both of the basic versions of the attack above require the adversary to generate and send data, consuming roughly the same amount of upstream bandwidth as the victim's available memory. The efficient version reduces this cost by one to two orders of magnitude.&lt;/p&gt;
&lt;p&gt;In the efficient version, the adversary controls &lt;b&gt;only a client&lt;/b&gt;. She creates a circuit, choosing the victim for the entry position, and then instructs the exit relay to download a large file from some external Internet server. The client stops reading on the TCP connection to the entry relay, causing it to buffer 1000 cells.&lt;/p&gt;
&lt;p&gt;At this point, the adversary may &quot;trick&quot; the exit relay into sending more cells by sending it a SENDME cell, even though the client has not actually received any cells from the entry. As long as this SENDME does not increase the exit relay's package counter to greater than 1000 cells, the exit relay will continue to package data from the server and send it into the circuit toward the victim. If the SENDME does cause the exit relay's package window to exceed the 1000 cell limit, it will stop responding on that circuit. However, the entry and middle node will hold the circuit open until the client issues another command, meaning its resources will not be freed.&lt;/p&gt;
&lt;p&gt;The bandwidth cost of the attack after circuit creation is simply the bandwidth cost of occasionally sending a SENDME to the exit. The memory consumption speed depends on the bandwidth and congestion of non-victim circuit relays. We describe how to parallelize the attack using multiple circuits and multiple paths with diverse relays in order to draw upon Tor's inherent resources. We found that with roughly 50 KiB/s of upstream bandwidth, an attacker could consume the victim's memory at roughly 1 MiB/s. This is highly dependent on the victim's bandwidth capabilities: relays that use token buckets to restrict bandwidth usage will of course bound the attack's consumption rate.&lt;/p&gt;
&lt;p&gt;Rather than connecting directly to the victim, the adversary may instead launch the attack through a separate Tor circuit using a second client instance and the &quot;Socks4Proxy&quot; or &quot;Socks5Proxy&quot; option. In this case, she may benefit from the anonymity that Tor itself provides in order to evade detection. We found that there is not a significant increase in bandwidth usage when anonymizing the attack in this way.&lt;/p&gt;
&lt;h1&gt;Defenses&lt;/h1&gt;
&lt;p&gt;A simple but naive defense against the Sniper Attack is to have the guard node watch its queue length, and if it ever fills to over 1000 cells, kill the circuit. This defense does not prevent the adversary from parallelizing the attack by using multiple circuits (and then consuming 1000 cells on each), which we have shown to be extremely effective.&lt;/p&gt;
&lt;p&gt;Another defense, called &quot;authenticated SENDMEs&quot;, tries to protect against receiving a SENDME from a node that didn't actually receive 100 cells. In this approach, a 1 byte nonce is placed in every 100th cell by the packaging end, and that nonce must be included by the delivery end in the SENDME (otherwise the packaging end rejects the SENDME as inauthentic). As above, this does not protect against the parallel attack. It also doesn't defend against either of the basic attacks where the adversary controls the packaging end and ignores the SENDMEs anyway.&lt;/p&gt;
&lt;p&gt;The best defense, as we suggested to the Tor developers, is to implement a custom, adaptive out-of-memory circuit killer in application space (i.e. inside Tor). The circuit killer is only activated when memory becomes scarce, and then it chooses the circuit with the oldest front-most cell in its circuit queue. This will prevent the Sniper Attack by killing off all of the attack circuits.&lt;/p&gt;
&lt;p&gt;With this new defense in place, the next game is for the adversary to try to cause Tor to kill an honest circuit. In order for an adversary to cause an honest circuit to get killed, it must ensure that the front-most cell on its malicious circuit queue is at least slightly &quot;younger&quot; than the oldest cell on any honest queue. We show that the Sniper Attack is impractical with this defense: due to fairness mechanisms in Tor, the adversary must spend an extraordinary amount of bandwidth keeping its cells young &amp;mdash; bandwidth that would likely be better served in a more traditional brute-force DoS attack.&lt;/p&gt;
&lt;p&gt;Tor has implemented a version of the out-of-memory killer for circuits, and is currently working on &lt;a href=&quot;https://trac.torproject.org/projects/tor/ticket/10169&quot;&gt;expanding this to channel and connection buffers&lt;/a&gt; as well.&lt;/p&gt;
&lt;h1&gt;Hidden Service Attack and Countermeasures&lt;/h1&gt;
&lt;p&gt;The paper also shows how the Sniper Attack can be used to deanonymize hidden services:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt; run a malicious entry guard relay;&lt;/li&gt;
&lt;li&gt; run &lt;a href=&quot;http://freehaven.net/anonbib/#oakland2013-trawling&quot;&gt;the attack from Oakland 2013&lt;/a&gt; to learn the current guard relay of the target hidden service;&lt;/li&gt;
&lt;li&gt; run the Sniper Attack on the guard from step 2, knocking it offline and causing the hidden service to choose a new guard;&lt;/li&gt;
&lt;li&gt; repeat, until the hidden service chooses the relay from step 1 as its new entry guard.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
The technique to verify that the hidden service is using a malicious guard in step 4 is the same technique used in step 2.&lt;/p&gt;
&lt;p&gt;In the paper, we compute the expected time to succeed in this attack while running malicious relays of various capacities. It takes longer to succeed against relays that have more RAM, since it relies on the Sniper Attack to consume enough RAM to kill the relay (which itself depends on the bandwidth capacity of the victim relay). For the malicious relay bandwidth capacities and honest relay RAM amounts used in their estimate, we found that deanonymization would involve between 18 and 132 Sniper Attacks and take between ~4 and ~278 hours.&lt;/p&gt;
&lt;p&gt;This attack becomes much more difficult if the relay is rebooted soon after it crashes, and the attack is ineffective when Tor relays are properly defending against the Sniper Attack (see the &quot;Defenses&quot; section above).&lt;/p&gt;
&lt;p&gt;Strategies to defend hidden services in particular go beyond &lt;a href=&quot;https://blog.torproject.org/blog/improving-tors-anonymity-changing-guard-parameters&quot;&gt;those suggested here&lt;/a&gt; to include &lt;b&gt;entry guard rate-limiting&lt;/b&gt;, where you stop building circuits if you notice that your new guards keep going down (failing closed), and &lt;b&gt;middle guards&lt;/b&gt;, guard nodes for your guard nodes. Both of these strategies attempt to make it harder to coerce the hidden service into building new circuits or exposing itself to new relays, since that is precisely what is needed for deanonymization.&lt;/p&gt;
&lt;h1&gt;Open Problems&lt;/h1&gt;
&lt;p&gt;The main defense implemented in Tor will start killing circuits when memory gets low. Currently, Tor uses a configuration option (MaxMemInCellQueues) that allows a relay operator to configure when the circuit-killer should be activated. There is likely not one single value that makes sense here: if it is too high, then relays with lower memory will not be protected; if it is too low, then there may be more false positives resulting in honest circuits being killed. Can Tor determine this setting in an OS-independent way that allows relays to automatically find the right value for MaxMemInCellQueues?&lt;/p&gt;
&lt;p&gt;The defenses against the Sniper Attack prevent the adversary from crashing the victim relay, but the adversary may still consume a relay's bandwidth (and memory resources, to a critical level) at relatively low cost. This means that even though the Sniper Attack can no longer kill a relay, it can still consume a large amount of its bandwidth at a relatively low cost (similar to more traditional bandwidth amplification attacks). More analysis of &lt;b&gt;general bandwidth consumption attacks and defenses&lt;/b&gt; remains a useful research problem.&lt;/p&gt;
&lt;p&gt;Finally, &lt;a href=&quot;https://blog.torproject.org/blog/hidden-services-need-some-love&quot;&gt;hidden services also need some love&lt;/a&gt;. More work is needed to redesign them in a way that does not allow a client to cause the hidden service to choose new relays on demand.&lt;/p&gt;</content><author><name>Rob G. Jansen</name><email>rob.g.jansen@nrl.navy.mil</email></author><category term="tor" /><category term="denial of service" /><category term="dos" /><category term="hidden services" /><summary>This post originally appeared on the TorProject blog summarizing our “Sniper Attack” publication.</summary></entry></feed>
